<div class="instructor-dashboard" *ngIf="!loading">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>Welcome back, {{ currentUser.name || 'Instructor' }}!</h1>
      <p>Manage your courses and track your teaching progress</p>
    </div>

  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid" *ngIf="instructorStats">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon courses">
            <mat-icon>school</mat-icon>
          </div>
          <div class="stat-details">
            <h3>{{ instructorStats.totalCourses }}</h3>
            <p>Total Courses</p>
            <small>{{ getCoursesDisplay() }}</small>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon students">
            <mat-icon>people</mat-icon>
          </div>
          <div class="stat-details">
            <h3>{{ formatNumber(instructorStats.totalStudents) }}</h3>
            <p>Total Students</p>
            <small>{{ instructorStats.totalEnrollments }} enrollments</small>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon rating">
            <mat-icon>star</mat-icon>
          </div>
          <div class="stat-details">
            <h3>{{ instructorStats.averageRating }}/5</h3>
            <p>Average Rating</p>
            <small>Across all courses</small>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon completion">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="stat-details">
            <h3>{{ instructorStats.completionRate }}%</h3>
            <p>Completion Rate</p>
            <small>Student success rate</small>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Loading state for stats -->
  <div class="stats-loading" *ngIf="!instructorStats">
    <mat-card>
      <mat-card-content>
        <p>Loading statistics...</p>
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Main Content Area -->
  <div class="dashboard-content">
    <!-- Left Column - Recent Courses -->
    <div class="left-column">
      <!-- Recent Courses Card -->
      <mat-card class="recent-courses-card">
        <mat-card-header>
          <mat-card-title>Recent Courses</mat-card-title>
          <mat-card-subtitle>Your latest course activities</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <!-- Show courses if they exist -->
          <div class="courses-list" *ngIf="recentCourses.length > 0; else noCourses">
            <div class="course-item" *ngFor="let course of recentCourses" (click)="navigateToCourse(course.id)">
              <div class="course-thumbnail">
                <img [src]="course.thumbnail" [alt]="course.title"
                  onerror="this.src='assets/images/default-course.jpeg'">
              </div>
              <div class="course-info">
                <h4>{{ course.title }}</h4>
                <div class="course-status">
                  <span class="status-badge" [class]="getStatusColor(course.status)">
                    {{ course.status | titlecase }}
                  </span>
                  <small *ngIf="course.status === 'rejected' && course.rejectionMessage" class="rejection-message">
                    <mat-icon color="warn" style="vertical-align: middle;">error_outline</mat-icon>
                    {{ course.rejectionMessage.rejectionReason }}
                  </small>
                </div>
                <small class="course-date">Created: {{ course.createdAt | date:'shortDate' }}</small>
              </div>
              <div class="course-actions">
                <button mat-icon-button>
                  <mat-icon>arrow_forward</mat-icon>
                </button>
              </div>
            </div>
          </div>

          <!-- Show this when no courses exist -->
          <ng-template #noCourses>
            <div class="empty-state">
              <mat-icon>school</mat-icon>
              <h4>No courses yet</h4>
              <p>Create your first course to get started</p>
              <button mat-button color="primary" routerLink="/instructor/create-course">
                Create Course
              </button>
            </div>
          </ng-template>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button routerLink="/instructor/my-courses">View All Courses</button>
        </mat-card-actions>
      </mat-card>
    </div>

    <!-- Right Column - Actions -->
    <div class="right-column">

      <!-- Quick Actions Card -->
      <mat-card class="quick-stats-card" *ngIf="instructorStats">
        <mat-card-header>
          <mat-card-title>Quick Overview</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="quick-stat">
            <span class="label">Approved Courses:</span>
            <span class="value approved">{{ instructorStats.activeCourses }}</span>
          </div>
          <div class="quick-stat">
            <span class="label">Pending Approvals:</span>
            <span class="value pending">{{ instructorStats.pendingApprovals }}</span>
          </div>
          <div class="quick-stat">
            <span class="label">Rejected Courses:</span>
            <span class="value rejected">{{ instructorStats.rejectedCourses }}</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>

<!-- Loading State -->
<div class="loading-container" *ngIf="loading">
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  <p>Loading dashboard...</p>
</div>